Traceback (most recent call last):
  File "/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 173, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/share/miniconda/envs/ols-stats/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
cohort_continent_df = (
    honor_df
    .drop(columns = ["Role", "Country"])
    .groupby(by=["Continent","Cohort"])
    .sum()
)
cohort_continent_df = pd.pivot_table(amount_df, index = 'Continent', columns = 'Cohort', values="Amount")
cohort_continent_df
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Cell [0;32mIn[18], line 7[0m
[1;32m      1[0m cohort_continent_df [38;5;241m=[39m (
[1;32m      2[0m     honor_df
[1;32m      3[0m     [38;5;241m.[39mdrop(columns [38;5;241m=[39m [[38;5;124m"[39m[38;5;124mRole[39m[38;5;124m"[39m, [38;5;124m"[39m[38;5;124mCountry[39m[38;5;124m"[39m])
[1;32m      4[0m     [38;5;241m.[39mgroupby(by[38;5;241m=[39m[[38;5;124m"[39m[38;5;124mContinent[39m[38;5;124m"[39m,[38;5;124m"[39m[38;5;124mCohort[39m[38;5;124m"[39m])
[1;32m      5[0m     [38;5;241m.[39msum()
[1;32m      6[0m )
[0;32m----> 7[0m cohort_continent_df [38;5;241m=[39m [43mpd[49m[38;5;241;43m.[39;49m[43mpivot_table[49m[43m([49m[43mamount_df[49m[43m,[49m[43m [49m[43mindex[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mContinent[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mcolumns[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[38;5;124;43m'[39;49m[38;5;124;43mCohort[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mvalues[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mAmount[39;49m[38;5;124;43m"[39;49m[43m)[49m
[1;32m      8[0m cohort_continent_df

File [0;32m/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/pandas/core/reshape/pivot.py:99[0m, in [0;36mpivot_table[0;34m(data, values, index, columns, aggfunc, fill_value, margins, dropna, margins_name, observed, sort)[0m
[1;32m     96[0m     table [38;5;241m=[39m concat(pieces, keys[38;5;241m=[39mkeys, axis[38;5;241m=[39m[38;5;241m1[39m)
[1;32m     97[0m     [38;5;28;01mreturn[39;00m table[38;5;241m.[39m__finalize__(data, method[38;5;241m=[39m[38;5;124m"[39m[38;5;124mpivot_table[39m[38;5;124m"[39m)
[0;32m---> 99[0m table [38;5;241m=[39m [43m__internal_pivot_table[49m[43m([49m
[1;32m    100[0m [43m    [49m[43mdata[49m[43m,[49m
[1;32m    101[0m [43m    [49m[43mvalues[49m[43m,[49m
[1;32m    102[0m [43m    [49m[43mindex[49m[43m,[49m
[1;32m    103[0m [43m    [49m[43mcolumns[49m[43m,[49m
[1;32m    104[0m [43m    [49m[43maggfunc[49m[43m,[49m
[1;32m    105[0m [43m    [49m[43mfill_value[49m[43m,[49m
[1;32m    106[0m [43m    [49m[43mmargins[49m[43m,[49m
[1;32m    107[0m [43m    [49m[43mdropna[49m[43m,[49m
[1;32m    108[0m [43m    [49m[43mmargins_name[49m[43m,[49m
[1;32m    109[0m [43m    [49m[43mobserved[49m[43m,[49m
[1;32m    110[0m [43m    [49m[43msort[49m[43m,[49m
[1;32m    111[0m [43m[49m[43m)[49m
[1;32m    112[0m [38;5;28;01mreturn[39;00m table[38;5;241m.[39m__finalize__(data, method[38;5;241m=[39m[38;5;124m"[39m[38;5;124mpivot_table[39m[38;5;124m"[39m)

File [0;32m/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/pandas/core/reshape/pivot.py:168[0m, in [0;36m__internal_pivot_table[0;34m(data, values, index, columns, aggfunc, fill_value, margins, dropna, margins_name, observed, sort)[0m
[1;32m    165[0m             [38;5;28;01mpass[39;00m
[1;32m    166[0m     values [38;5;241m=[39m [38;5;28mlist[39m(values)
[0;32m--> 168[0m grouped [38;5;241m=[39m [43mdata[49m[38;5;241;43m.[39;49m[43mgroupby[49m[43m([49m[43mkeys[49m[43m,[49m[43m [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m[43m [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m[43m [49m[43mdropna[49m[38;5;241;43m=[39;49m[43mdropna[49m[43m)[49m
[1;32m    169[0m agged [38;5;241m=[39m grouped[38;5;241m.[39magg(aggfunc)
[1;32m    171[0m [38;5;28;01mif[39;00m dropna [38;5;129;01mand[39;00m [38;5;28misinstance[39m(agged, ABCDataFrame) [38;5;129;01mand[39;00m [38;5;28mlen[39m(agged[38;5;241m.[39mcolumns):

File [0;32m/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/pandas/core/frame.py:8869[0m, in [0;36mDataFrame.groupby[0;34m(self, by, axis, level, as_index, sort, group_keys, observed, dropna)[0m
[1;32m   8866[0m [38;5;28;01mif[39;00m level [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m by [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m   8867[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([38;5;124m"[39m[38;5;124mYou have to supply one of [39m[38;5;124m'[39m[38;5;124mby[39m[38;5;124m'[39m[38;5;124m and [39m[38;5;124m'[39m[38;5;124mlevel[39m[38;5;124m'[39m[38;5;124m"[39m)
[0;32m-> 8869[0m [38;5;28;01mreturn[39;00m [43mDataFrameGroupBy[49m[43m([49m
[1;32m   8870[0m [43m    [49m[43mobj[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[43m,[49m
[1;32m   8871[0m [43m    [49m[43mkeys[49m[38;5;241;43m=[39;49m[43mby[49m[43m,[49m
[1;32m   8872[0m [43m    [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m   8873[0m [43m    [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m   8874[0m [43m    [49m[43mas_index[49m[38;5;241;43m=[39;49m[43mas_index[49m[43m,[49m
[1;32m   8875[0m [43m    [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m   8876[0m [43m    [49m[43mgroup_keys[49m[38;5;241;43m=[39;49m[43mgroup_keys[49m[43m,[49m
[1;32m   8877[0m [43m    [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[1;32m   8878[0m [43m    [49m[43mdropna[49m[38;5;241;43m=[39;49m[43mdropna[49m[43m,[49m
[1;32m   8879[0m [43m[49m[43m)[49m

File [0;32m/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/pandas/core/groupby/groupby.py:1278[0m, in [0;36mGroupBy.__init__[0;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, observed, dropna)[0m
[1;32m   1275[0m [38;5;28mself[39m[38;5;241m.[39mdropna [38;5;241m=[39m dropna
[1;32m   1277[0m [38;5;28;01mif[39;00m grouper [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m-> 1278[0m     grouper, exclusions, obj [38;5;241m=[39m [43mget_grouper[49m[43m([49m
[1;32m   1279[0m [43m        [49m[43mobj[49m[43m,[49m
[1;32m   1280[0m [43m        [49m[43mkeys[49m[43m,[49m
[1;32m   1281[0m [43m        [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m   1282[0m [43m        [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m   1283[0m [43m        [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m   1284[0m [43m        [49m[43mobserved[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m [49m[38;5;28;43;01mif[39;49;00m[43m [49m[43mobserved[49m[43m [49m[38;5;129;43;01mis[39;49;00m[43m [49m[43mlib[49m[38;5;241;43m.[39;49m[43mno_default[49m[43m [49m[38;5;28;43;01melse[39;49;00m[43m [49m[43mobserved[49m[43m,[49m
[1;32m   1285[0m [43m        [49m[43mdropna[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdropna[49m[43m,[49m
[1;32m   1286[0m [43m    [49m[43m)[49m
[1;32m   1288[0m [38;5;28;01mif[39;00m observed [38;5;129;01mis[39;00m lib[38;5;241m.[39mno_default:
[1;32m   1289[0m     [38;5;28;01mif[39;00m [38;5;28many[39m(ping[38;5;241m.[39m_passed_categorical [38;5;28;01mfor[39;00m ping [38;5;129;01min[39;00m grouper[38;5;241m.[39mgroupings):

File [0;32m/usr/share/miniconda/envs/ols-stats/lib/python3.11/site-packages/pandas/core/groupby/grouper.py:1009[0m, in [0;36mget_grouper[0;34m(obj, key, axis, level, sort, observed, validate, dropna)[0m
[1;32m   1007[0m         in_axis, level, gpr [38;5;241m=[39m [38;5;28;01mFalse[39;00m, gpr, [38;5;28;01mNone[39;00m
[1;32m   1008[0m     [38;5;28;01melse[39;00m:
[0;32m-> 1009[0m         [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m(gpr)
[1;32m   1010[0m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(gpr, Grouper) [38;5;129;01mand[39;00m gpr[38;5;241m.[39mkey [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m   1011[0m     [38;5;66;03m# Add key to exclusions[39;00m
[1;32m   1012[0m     exclusions[38;5;241m.[39madd(gpr[38;5;241m.[39mkey)

[0;31mKeyError[0m: 'Cohort'

